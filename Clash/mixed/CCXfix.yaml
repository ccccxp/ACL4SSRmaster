#适用于mihomo内核，在ios端为clash mi，需要外区id下载
#嗅探器关掉本机可能出现上网异常，连接本机热点的设备可能无法上网
sniffer:
  enable: true
  parse-pure-ip: true
  force-dns-mapping: true
  override-destination: false
  sniff:
    HTTP:
      ports:
        - 80
        - 443
      override-destination: false
    TLS:
      ports:
        - 443
  skip-domain:
    - +.push.apple.com
  skip-dst-address:
    - 91.105.192.0/23
    - 91.108.4.0/22
    - 91.108.8.0/21
    - 91.108.16.0/21
    - 91.108.56.0/22
    - 95.161.64.0/20
    - 149.154.160.0/20
    - 185.76.151.0/24
    - 2001:67c:4e8::/48
    - 2001:b28:f23c::/47
    - 2001:b28:f23f::/48
    - 2a0a:f280:203::/48
#tun必须开启，否则将无法代理流量，如网页打开慢，电报卡连接中，
#可以尝试更换堆栈，同一堆栈在不同设备上体验不同，自行尝试。
#更换为非gvisor堆栈可能导致IPv6出现问题
tun:
  enable: true
  device: Clash Mi
  stack: gVisor
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true
  dns-hijack:
    - any:53
  route-exclude-address: []
  mtu: 1500
  loopback-address:
    - 10.7.0.1
#exclude-package内填写的包名，网络流量不经过tun，相当于黑名单
#默认添加MIUI镜像服务以及三星电话服务，避免系统功能不可用
#如果想仅代理指定应用，请将exclude-package改为include-package
#然后填上想要走代理的包名，不要忘了英文冒号和缩进。
#目前分流规则已足够完善，白名单可能存在问题，不建议使用
#添加dns设置来确保开启clash时访问国内网站卡顿
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  ipv6-timeout: 300
  respect-rules: true
  enhanced-mode: fake-ip
  use-hosts: false
  use-system-hosts: false
  fallback: []
  fallback-filter:
    domain:
    - +.google.com
    - +.facebook.com
    - +.youtube.com
    geoip: true
    geoip-code: CN
    ipcidr:
    - 240.0.0.0/4
    - 0.0.0.0/32
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
    - '*.local'
    - time.*.com
    - time.*.gov
    - time.*.edu.cn
    - time.*.apple.com
    - time-ios.apple.com
    - time1.*.com
    - time2.*.com
    - time3.*.com
    - time4.*.com
    - time5.*.com
    - time6.*.com
    - time7.*.com
    - ntp.*.com
    - ntp1.*.com
    - ntp2.*.com
    - ntp3.*.com
    - ntp4.*.com
    - ntp5.*.com
    - ntp6.*.com
    - ntp7.*.com
    - '*.time.edu.cn'
    - '*.ntp.org.cn'
    - '*.pool.ntp.org'
    - +.services.googleapis.cn
    - +.push.apple.com
    - time1.cloud.tencent.com
    - localhost.ptlogin2.qq.com
    - +.stun.*.*
    - +.stun.*.*.*
    - +.stun.*.*.*.*
    - +.stun.*.*.*.*.*
    - lens.l.google.com
    - '*.n.n.srv.nintendo.net'
    - +.stun.playstation.net
    - xbox.*.*.microsoft.com
    - '*.*.xboxlive.com'
    - '*.msftncsi.com'
    - '*.msftconnecttest.com'
    - '*.mcdn.bilivideo.cn'
    - +.bilibili.com
    - +.bilicdn.com
    - +.bilivideo.com
    - +.market.xiaomi.com
    - WORKGROUP
    - +.market.xiaomi.com
    - localhost.ptlogin2.qq.com
    - localhost.sec.qq.com
    - +.qq.com
    - +.tencent.com
    - +.msftconnecttest.com
    - +.msftncsi.com
  fake-ip-filter-mode: blacklist
  default-nameserver:
    - system
    - 223.6.6.6
    - 119.29.29.29 
    - 8.8.8.8
    - 8.8.4.4
    - 2400:3200::1
    - 2001:4860:4860::8888
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - 8.8.8.8
    - 8.8.4.4
    - 1.0.0.1
    - 1.1.1.1
    - tls://223.5.5.5
    - tls://223.5.5.5:853
    - tls://8.8.8.8
    - tls://8.8.4.4
    - tls://1.0.0.1
    - tls://1.1.1.1
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    - https://dns.alidns.com/dns-query#h3=true
    - https://mozilla.cloudflare-dns.com/dns-query#DNS&h3=true
    - system
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    - tls://223.5.5.5
  direct-nameserver: []
  direct-nameserver-follow-policy: false
  nameserver-policy: {}
# 直接覆盖整个规则
#rules:
#  - DOMAIN,baidu.com,DIRECT
# 将规则插入到原规则前面
#rules:
#  - DOMAIN,baidu.com,DIRECT
# 在原规则后面追加规则
#rules+:
#  - DOMAIN,baidu.com,DIRECT
